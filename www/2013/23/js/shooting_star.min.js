/*! shooting_star 2013-12-23 */
var Background=function(){PIXI.DisplayObjectContainer.call(this),this.tiles=[PIXI.Texture.fromImage("img/tiles/StripTIle_01.png"),PIXI.Texture.fromImage("img/tiles/StripTIle_02.png"),PIXI.Texture.fromImage("img/tiles/StripTIle_03.png"),PIXI.Texture.fromImage("img/tiles/StripTIle_04.png"),PIXI.Texture.fromImage("img/tiles/StripTIle_05.png"),PIXI.Texture.fromImage("img/tiles/StripTIle_06.png"),PIXI.Texture.fromImage("img/tiles/StripTIle_07.png")],this.colors=[14536724,14505236,9092527,6322538,3299485,6902131,3898197];var a=PIXI.Texture.fromImage("img/tiles/StripTIle_01.png");this.tiling=new PIXI.TilingSprite(a,1600,900),a.baseTexture._powerOf2=!0,this.addChild(this.tiling),this.fill=new PIXI.Graphics,this.fill.beginFill(3299485),this.fill.drawRect(-900,0,1800,600),this.fill.beginFill(4600386),this.fill.drawRect(-900,-10,1800,20),this.fill.position.y=400,this.fill.position.x=800,this.addChild(this.fill),this.count=Math.random(),this.tileCount=0};Background.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),Background.prototype.shakeup=function(){this.tileCount++;var a=this.tileCount%this.tiles.length,b=this.tiles[a],c=PIXI.gl;b.baseTexture._glTexture&&(c.bindTexture(c.TEXTURE_2D,b.baseTexture._glTexture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT),this.tiling.texture.baseTexture._powerOf2=!0),this.tiles[a].baseTexture._powerOf2=!0,this.tiling.setTexture(this.tiles[a]),this.fill.clear();var d=this.colors[a];this.fill.beginFill(d),this.fill.drawRect(-900,0,1800,600),this.fill.beginFill(4600386),this.fill.drawRect(-900,-10,1800,20),this.fill.position.y=400,this.fill.position.x=800},Background.prototype.update=function(){this.tiling.tilePosition.x+=1,this.tiling.tilePosition.y+=1,this.count+=.001,this.fill.rotation=.3*Math.sin(this.count),this.fill.position.y=600+100*Math.cos(this.count)};var Bow=function(){PIXI.DisplayObjectContainer.call(this),this.tent=new Tentacle(PIXI.Texture.fromImage("img/bowString1.png"),1e3,10),this.tent2=new Tentacle(PIXI.Texture.fromImage("img/bowString2.png"),1e3,10),this.tent2.chain.gravity*=.7,this.addChild(this.tent),this.addChild(this.tent2),this.top=new PIXI.DisplayObjectContainer,this.bow=PIXI.Sprite.fromImage("img/BowKnot.png"),this.left=PIXI.Sprite.fromImage("img/BowRear.png"),this.right=PIXI.Sprite.fromImage("img/BowFront.png"),this.left.position.y=-10,this.left.rotation=.8,this.right.rotation=-0.8,this.left.anchor.y=1,this.right.anchor.y=1,this.left.anchor.x=.5,this.right.anchor.x=.5,this.top.addChild(this.left),this.top.addChild(this.bow),this.top.addChild(this.right),this.bow.anchor.x=this.bow.anchor.y=.5,this.addChild(this.top)};Bow.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),Bow.prototype.reset=function(a){this.tent.chain.reset(a),this.tent2.chain.reset(a)},Bow.prototype.update=function(a,b){this.top.position.x=a,this.top.position.y=b,this.tent.chain.startX=a-10,this.tent.chain.startY=b-30,this.tent2.chain.startX=a-10,this.tent2.chain.startY=b-10};var Chain=function(){this.startX=0,this.startY=0,this.gravity=1.4;var a=0,b=400,c=6,d=45,e=1/60,f=[],g=[],h=[],i=[];this.links=[],this.build=function(a){d=a/c,e=.1;var b,j=0,k=-d;for(b=0;c>=b;b++)f[b]=this.startX+j*b+b,g[b]=this.startY+k*b,h[b]=this.startX+j*b,i[b]=this.startY+k*b,this.links[b]=new PIXI.Point(20*b,20*b)},this.update=function(){f[0]=this.startX,g[0]=this.startY,this.verlet(),this.satisfyConstraints(),this.satisfyJoints()},this.satisfyJoints=function(){for(var a=0;c>=a;a++)this.links[a].x=f[a],this.links[a].y=g[a]},this.detect=function(a){for(var b,d=150,e=2;c-1>e;e++){b=this.links[e];var j=a.x-f[e],k=a.y-g[e],l=Math.sqrt(j*j+k*k);if(d>l){var m=-j/l,n=-k/l;f[e]=h[e]=a.x+m*d,g[e]=i[e]=a.y+n*d}}},this.getAngle=function(a,b,c,d){var e=a-c,f=b-d;return Math.atan2(f,e)},this.verlet=function(){for(var a=0;c>=a;a++){var b=f[a],d=g[a],e=.96;f[a]+=1*(e*f[a]-e*h[a]),g[a]+=1*(e*g[a]-e*i[a])+this.gravity,h[a]=b,i[a]=d}},this.satisfyConstraints=function(){for(var a=1;c>=a;a++){var b=f[a]-f[a-1],e=g[a]-g[a-1],h=Math.sqrt(b*b+e*e),i=h-d,j=i*b/h/2,k=i*e/h/2;f[a]-=j,g[a]-=k,f[a-1]+=j,g[a-1]+=k}},this.reset=function(a){var b=250;d=b/c,e=.1,console.log(a);var j,k=a?20:-20,l=-d;for(j=0;c>=j;j++)f[j]=this.startX+k*j+j,g[j]=this.startY+l*j,h[j]=this.startX+k*j,i[j]=this.startY+l*j},this.destroy=function(){f=null,g=null,h=null,i=null,links=null},this.setLength=function(e,j){e*=.8;var k=a-this.startX,l=b-this.startY;if(k/=c,l/=c,d=e/c,j)for(var m=0;c>m;m++)f[m]=h[m]=this.startX+k*m,g[m]=i[m]=this.startY+l*m}},Clouds=function(){PIXI.DisplayObjectContainer.call(this),this.clouds=[];for(var a=0;20>a;a++){var b=new PIXI.Sprite.fromImage("img/cloudGrad.png"),c=a/20*Math.PI*2,d=21;b.rotation=-c+Math.PI/2,b.anchor.x=b.anchor.y=.5,b.speed=new PIXI.Point(Math.sin(c)*d,Math.cos(c)*d),b.scale.x=b.scale.y=1+2*Math.random(),b.decay=.9,this.clouds.push(b),this.addChild(b)}this.reset(),this.popArtFilter=new PIXI.DustFilter,this.filters=[this.popArtFilter],this.county=0,this.visible=!1};Clouds.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),Clouds.prototype.reset=function(){this.exploding=!1,this.visible=!1,this.county=0;for(var a=0;a<this.clouds.length;a++){var b=this.clouds[a],c=a/20*Math.PI*2,d=10+13*Math.random();b.speed=new PIXI.Point(Math.sin(c)*d,Math.cos(c)*d),b.position.x+=10*b.speed.x,b.position.y+=10*b.speed.y,b.scale.x=b.scale.y=1+4*Math.random(),b.position.x=b.position.y=0,b.alpha=1,b.decay=.94+.04*Math.random()}},Clouds.prototype.explode=function(){this.exploding=!0,this.visible=!0},Clouds.prototype.update=function(){if(this.exploding){this.county++;for(var a=0;a<this.clouds.length;a++){var b=this.clouds[a];b.speed.x*=.96,b.speed.y*=.96,b.position.x+=b.speed.x,b.position.y+=b.speed.y,this.county>30&&(b.alpha*=b.decay)}}};var CrackerAPP=function(){this.w=0,this.h=0,this.music=new Howl({urls:["snd/chemical.mp3"],autoplay:!0,loop:!0,volume:1}),this.pops=[],this.popCount=0;for(var a=0;9>a;a++){var b=new Howl({urls:["snd/crack"+(a+1)+".mp3"],autoplay:!1,loop:!1,volume:1});this.pops.push(b)}this.wordList=["SNAP!","CRACK!","BRATT!","WHACK!","SHAZOO!","BLAMM!","KABOOM!","BLAMMO!","ZABONGA!"],this.wordCount=0,this.stage=new PIXI.Stage(268435455),this.bg=new Background,this.stage.addChild(this.bg),this.renderer=PIXI.autoDetectRenderer(400,300),this.renderer.view.style.position="absolute",document.body.appendChild(this.renderer.view),this.assetLoader=new PIXI.AssetLoader(["img/title.png","img/overlay.jpg","img/tiles/StripTIle_01.png"]),this.assetLoader.onComplete=function(){this.onPreload()}.bind(this),this.assetLoader.load()};CrackerAPP.prototype.onPreload=function(){this.assetLoader=new PIXI.AssetLoader(["img/Chars.json","img/gem/gems.json","img/bowString1.png","img/bowString2.png","img/BowFront.png","img/asplodeLines.png","img/BowKnot.png","img/instruction.png","img/BowRear.png","img/cloudGrad.png","img/cracker_01.png","img/cracker_02.png","img/cracker_03.png","img/cracker_04.png","img/cracker_05.png","img/map.png","img/overlay.jpg","img/spike.png","img/spikeMid.png","img/spikeRear.png","img/tiles/StripTIle_01.png","img/tiles/StripTIle_02.png","img/tiles/StripTIle_03.png","img/tiles/StripTIle_04.png","img/tiles/StripTIle_05.png","img/tiles/StripTIle_06.png","img/tiles/StripTIle_07.png"]),this.assetLoader.onComplete=function(){this.init()}.bind(this),this.preloded=!0,this.tint=new PIXI.Graphics,this.tint.beginFill(0,1),this.tint.drawRect(0,0,100,100),this.stage.addChild(this.tint),this.loading=PIXI.Sprite.fromImage("img/title.png"),this.loading.anchor.x=this.loading.anchor.y=.5,this.loading.alpha=0,this.loading.pivot.y=100,this.stage.addChild(this.loading),this.overlay=new PIXI.Sprite.fromImage("img/overlay.jpg"),this.overlay.blendMode="multiply",this.stage.addChild(this.overlay),requestAnimFrame(this.update.bind(this));var a=window.innerWidth,b=window.innerHeight;this.resize(a,b),setTimeout(function(){TweenLite.to(this.loading,.5,{alpha:1,ease:Sine.easeIn}),TweenLite.to(this.loading.pivot,.8,{y:0,ease:Back.easeOut}),TweenLite.to(this.tint,1,{alpha:.4,ease:Sine.easeOut,delay:.5}),this.assetLoader.load()}.bind(this),10)},CrackerAPP.prototype.init=function(){this.tut=PIXI.Sprite.fromImage("img/instruction.png"),this.stage.addChild(this.tut),this.count=0,this.holder=new PIXI.DisplayObjectContainer,this.stage.addChild(this.holder),this.master=new PIXI.DisplayObjectContainer,this.holder.addChild(this.master),this.cracker=new CrackerHalf(!1),this.cracker2=new CrackerHalf(!0),this.crackerContainer=new PIXI.DisplayObjectContainer,this.crackerContainer.position.y=400;var a=PIXI.Sprite.fromImage("img/test3.png");a.alpha=.5,this.temp=a;var b=new PIXI.Graphics;b.beginFill(16711680),b.drawCircle(0,0,10),b.drawCircle(350,0,10),this.crackerShadow=new PIXI.DisplayObjectContainer,this.crackerShadow.addChild(this.cracker.shadow),this.crackerShadow.addChild(this.cracker2.shadow),this.crackerContainer.addChild(this.crackerShadow),this.crackerShadow.filters=[new PIXI.ShadowFilter],this.crackerContainer.addChild(this.cracker),this.crackerContainer.addChild(this.cracker2),this.crackerShade=new PIXI.DisplayObjectContainer,this.crackerShade.addChild(this.cracker.shading),this.crackerShade.addChild(this.cracker2.shading),this.crackerContainer.addChild(this.crackerShade),this.master.addChild(this.crackerContainer),this.crackerShade.filters=[new PIXI.HalfToneFilter],this.stage.mousemove=this.stage.touchmove=this.onMouseMove.bind(this),this.stage.mousedown=this.stage.touchstart=this.onMouseDown.bind(this),this.stage.mouseup=this.touchend=this.onMouseUp.bind(this),this.offset=new PIXI.Point,this.spring=new DoubleSpring;new PIXI.BlurFilter;this.rt=new PIXI.RenderTexture(800,600),this.rtSprite=new PIXI.Sprite(this.rt),this.rtSprite.position.x=300,this.rtSprite.position.y=200,this.clouds=new Clouds,this.clouds.position.y=this.crackerContainer.position.y,this.spikes=new Spikes(0),this.spikes.position.y=this.crackerContainer.position.y,this.spikes2=new Spikes(1),this.spikes2.position.y=this.crackerContainer.position.y,this.spikes3=new Spikes(2),this.spikes3.position.y=this.crackerContainer.position.y,this.bow=new Bow(!0),this.bow2=new Bow(!1),this.shower=new Shower,this.shower.visible=!1,this.master.addChild(this.clouds),this.master.addChild(this.shower),this.master.addChild(this.spikes),this.master.addChild(this.spikes2),this.master.addChild(this.spikes3),this.blurFilter=new PIXI.DropShadowFilter,this.pop=new Pop,this.master.addChild(this.pop),this.crackerContainer.addChild(this.bow),this.crackerContainer.addChild(this.bow2),this.asplodeLines=new PIXI.Sprite.fromImage("img/asplodeLines.png"),this.asplodeLines.anchor.x=this.asplodeLines.anchor.y=.5,this.asplodeLines.blendMode="multiply",this.stage.addChild(this.asplodeLines),this.asplodeLines.visible=!1,this.logo=new DivButton("img/goodboy.png","img/goodboyOver.png"),document.body.appendChild(this.logo.view),this.logo.view.style.position="absolute",this.logo.view.style.right="10px",this.logo.view.style.bottom="10px",this.logo.view.onclick=function(){window.open("http://www.goodboydigital.com/","_blank")},this.info=new DivButton("img/siteInfo.png","img/goodboyOver.png"),document.body.appendChild(this.info.view),this.info.view.style.position="absolute",this.info.view.style.left="10px",this.info.view.style.bottom="10px",this.info.view.onclick=function(){TweenLite.to(this.tut,.3,{alpha:0,ease:Sine.easeOut}),this.toggle=!this.toggle;var a=document.getElementById("infoBox");this.toggle?$(a).fadeIn():$(a).fadeOut()}.bind(this),this.zoom=1;var c=window.innerWidth,d=window.innerHeight;this.crackerDisplace=new CrackerDisplace,this.displacement=new PIXI.RippleFilter(PIXI.Texture.fromImage("img/map.png")),this.master.scale.x=this.master.scale.y=.8,this.loaded=!0,this.attractCount=0,this.crackerContainer.pivot.y=800,TweenLite.to(this.crackerContainer.pivot,1.5,{ease:Elastic.easeOut,y:0,delay:2.5}),TweenLite.to(this.loading,.3,{ease:Sine.easeOut,alpha:0,delay:2.2}),TweenLite.to(this.loading.pivot,.5,{ease:Back.easeIn,y:-100,delay:2}),TweenLite.to(this.tint,1,{alpha:0,ease:Sine.easeOut,delay:.5,onComplete:function(){this.stage.removeChild(this.tint)}.bind(this)}),this.stage.addChild(this.overlay),this.resize(c,d)},CrackerAPP.prototype.onMouseDown=function(a){a&&a.originalEvent.preventDefault(),this.offset.x=a.global.x,this.offset.y=a.global.y,this.grabbed=!0},CrackerAPP.prototype.onMouseUp=function(a){a&&a.originalEvent.preventDefault(),this.snapped,this.attractCount=0,this.grabbed=!1,this.spring.tx=0,this.spring.ty=0},CrackerAPP.prototype.onMouseMove=function(a){if(a&&a.originalEvent.preventDefault(),this.grabbed){var b=(this.w/2,a.global.x-this.offset.x);b=Math.abs(b);var c=this.crackerContainer.position.y-a.global.y;c>100&&(c=100),-100>c&&(c=-100),this.spring.x=this.spring.tx=b,this.spring.y=this.spring.ty=c}},CrackerAPP.prototype.update=function(){return this.bg.update(),requestAnimFrame(this.update.bind(this)),this.loaded?(this.spring.update(),this.clouds.update(),this.spikes.update(),this.spikes2.update(),this.spikes3.update(),this.pop.update(),this.cracker.stretch=this.spring.x,this.cracker.curve=this.spring.y,this.cracker2.stretch=this.spring.x,this.cracker2.curve=this.spring.y,this.bow.update(this.cracker2.points[7].x+10,this.cracker2.points[7].y),this.bow.position.x=this.cracker2.position.x,this.bow.position.y=this.cracker2.position.y,this.bow2.update(this.cracker.points[7].x-10,this.cracker.points[7].y),this.bow2.position.x=this.cracker.position.x,this.bow2.position.y=this.cracker.position.y,this.snapped?(this.count++,this.drop?(this.cracker.drop(),this.cracker2.drop()):(this.cracker.position.x=-this.cracker.getRealWidth()+900,this.cracker2.position.x=this.cracker2.getRealWidth()-900,this.drop=!0),this.count>40?(this.asplodeLines.scale.x*=1.07,this.asplodeLines.scale.y*=1.07):(this.asplodeLines.scale.x*=1.02,this.asplodeLines.scale.y*=1.02)):this.crackerContainer.position.x=this.w/2,this.attractCount++,this.attractCount>150&&(this.grabbed||(this.spring.x=20*Math.sin(.1*this.attractCount),this.spring.y=this.spring.ty=20*Math.cos(.07*this.attractCount))),this.snapped||this.cracker.getRealWidth()>700&&(TweenLite.to(this.tut,.3,{alpha:0,ease:Sine.easeOut}),this.master.scale.x=this.master.scale.y=1.4,TweenLite.to(this.master.scale,1,{x:.8,y:.8,ease:Expo.easeOut}),this.onMouseUp(),this.shower.visible=!0,this.shower.count=0,this.snapped=!0,this.clouds.explode(),this.spikes.explode(0),this.spikes2.explode(.1),this.spikes3.explode(.2),this.pop.explode(this.wordList[this.wordCount%this.wordList.length]),this.wordCount++,this.asplodeLines.visible=!0,this.blurFilter.strength=1,setTimeout(this.reset.bind(this),3e3),this.displacement.uniforms.scale.value.y=180,this.displacement.uniforms.scale.value.x=180,this.displacement.uniforms.superScale.value.x=2,this.displacement.uniforms.superScale.value.y=this.displacement.uniforms.superScale.value.x/1.6,this.stage.filters=[this.displacement],this.displacement.uniforms.scale.value.x=this.displacement.uniforms.scale.value.y=100,TweenLite.to(this.displacement.uniforms.superScale.value,2,{x:.3,y:.3/1.6,ease:Expo.easeOut}),TweenLite.to(this.displacement.uniforms.scale.value,.5,{x:0,y:0,delay:1,ease:Sine.easeIn,onComplete:function(){this.stage.filters=null}.bind(this)}),this.pops[this.popCount%this.pops.length].play(),this.popCount++,this.zoom=1.2),this.renderer.render(this.stage),this.crackerDisplace.update(),void 0):(this.renderer.render(this.stage),void 0)},CrackerAPP.prototype.reset=function(){this.count=0,this.bg.shakeup(),this.snapped=!1,this.drop=!1,this.shower.visible=!1,this.shower.reset(),this.cracker.reset(),this.cracker2.reset(),this.spikes.reset(),this.spikes2.reset(),this.spikes3.reset(),this.clouds.reset(),this.asplodeLines.scale.x=1,this.asplodeLines.scale.y=1,this.asplodeLines.visible=!1,this.pop.reset(),this.bow.reset(),this.bow2.reset(!0),this.crackerContainer.pivot.y=500,TweenLite.to(this.crackerContainer.pivot,1,{ease:Elastic.easeOut,y:0})},CrackerAPP.prototype.resize=function(a,b){if(this.preloded){var c=a/1280>b/800?a/1280:b/800;this.renderer.view.style.width=1280*c+"px",this.renderer.view.style.height=800*c+"px",this.renderer.view.style.left=a/2-1280*c/2+"px",this.renderer.view.style.top=b/2-800*c/2+"px",this.overlay&&(this.overlay.position.x=640-a/c/2-2,this.overlay.width=a/c+4,this.overlay.height=800),a=1280,b=800,this.w=a,this.h=b,this.loading.position.x=a/2,this.loading.position.y=b/2,this.bg.width=a,this.bg.height=b,this.tint.scale.x=a/100,this.tint.scale.y=b/100,this.tut&&(this.tut.scale.x=this.tut.scale.y=.5,this.tut.position.x=Math.round(507.5),this.tut.position.y=Math.round(b-110)),this.renderer.resize(a,b),this.asplodeLines&&(this.asplodeLines.position.x=this.w/2,this.asplodeLines.position.y=this.h/2,this.clouds.position.x=this.w/2,this.spikes.position.x=this.w/2,this.spikes2.position.x=this.w/2,this.spikes3.position.x=this.w/2,this.pop.position.x=this.w/2,this.pop.position.y=this.h/2,this.master.position.x=this.w/2,this.master.position.y=this.h/2,this.master.pivot.x=this.w/2,this.master.pivot.y=this.h/2)}};var CrackerDisplace=function(){PIXI.DisplayObjectContainer.call(this),this.texture=new PIXI.RenderTexture(256,256),this.texture.baseTexture._powerOf2=!0,this.bg=new PIXI.Graphics,this.bg.beginFill(7171437),this.bg.drawRect(0,0,256,256),this.addChild(this.bg),this.addChild(PIXI.Sprite.fromImage("img/map.png"))};CrackerDisplace.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),CrackerDisplace.prototype.update=function(){};var CrackerHalf=function(a){this.shaderTexture=PIXI.Texture.fromImage("img/crackerHalftone.png"),this.shaderTexture2=PIXI.Texture.fromImage("img/tiles/StripTIle_01.png");var b=[];this.left=a,this.segs=15,this.segWidth=700/this.segs,this.segs;for(var c=0;c<this.segs;c++){var d=new PIXI.Point(c*this.segWidth,0);b.push(d)}PIXI.Rope.call(this,PIXI.Texture.fromImage("img/cracker_01.png"),b),this.textures=[PIXI.Texture.fromImage("img/cracker_01.png"),PIXI.Texture.fromImage("img/cracker_02.png"),PIXI.Texture.fromImage("img/cracker_03.png"),PIXI.Texture.fromImage("img/cracker_04.png"),PIXI.Texture.fromImage("img/cracker_05.png")],this.textCount=0,this.filterArea.x=0,this.filterArea.y=0,this.filterArea.width=800,this.filterArea.height=600,this.stretch=1,this.curve=0,a?(this.speedY=-20,this.speedX=-20,this.rotSpeed=-.01):(this.speedY=-20,this.speedX=20,this.rotSpeed=.01),!CrackerHalf.crackerShader,this.shading=new CrackerHalfGhost(this),this.shadow=new CrackerHalfGhost(this,!0)};CrackerHalf.prototype=Object.create(PIXI.Rope.prototype),CrackerHalf.prototype.updateFilterBounds=function(){this.filterArea.width=800,this.filterArea.height=800},CrackerHalf.prototype.refresh=function(){var a=this.points;if(!(a.length<1)){var b=this.uvs,c=this.indices,d=this.colors,e=a[0],f=a[0];this.count-=.2,b[0]=0,b[1]=1,b[2]=0,b[3]=1,d[0]=1,d[1]=1,c[0]=0,c[1]=1;for(var g=a.length,h=this.left?0:.5,i=0;g>i;i++){var f=a[i],j=4*i,k=i/(g-1);i%2?(b[j]=.5*k+h,b[j+1]=0,b[j+2]=.5*k+h,b[j+3]=1):(b[j]=.5*k+h,b[j+1]=0,b[j+2]=.5*k+h,b[j+3]=1),j=2*i,d[j]=1,d[j+1]=1,j=2*i,c[j]=j,c[j+1]=j+1,e=f}}},CrackerHalf.prototype.drop=function(){this.speedY+=1.4,this.speedX*=.9,this.position.y+=this.speedY,this.position.x+=this.speedX,this.rotation+=this.rotSpeed},CrackerHalf.prototype.reset=function(){this.left?(this.speedY=-20,this.speedX=-20,this.rotSpeed=-.01):(this.speedY=-20,this.speedX=20,this.rotSpeed=.01),this.position.x=0,this.position.y=0,this.rotation=0,this.textCount++,this.texture=this.textures[this.textCount%this.textures.length]},CrackerHalf.prototype.getRealWidth=function(){return 350+this.stretch},CrackerHalf.prototype.explode=function(){this.snapped=!0},CrackerHalf.prototype.updateTransform=function(){var a=this.points;if(!(a.length<1)){var b,c=this.verticies,d=a[0],e={x:0,y:0},f=a[0];this.count-=.2,c[0]=f.x+e.x,c[1]=f.y+e.y,c[2]=f.x-e.x,c[3]=f.y-e.y;for(var g=a.length,h=(350+this.stretch)/(this.segs-1),i=this.left?350+this.stretch:0,j=this.left?0:Math.PI/2,k=0;g>k;k++){f=a[k];{a[k-1]}f.x=k*h-i;var l=k/this.segs;f.y=Math.sin(j+l*Math.PI*.5)*this.curve-.8*this.curve}for(var k=0;g>k;k++){var f=a[k],m=4*k;b=k<a.length-1?a[k+1]:f,e.y=-(b.x-d.x),e.x=b.y-d.y;var n=10*(1-k/(g-1));n>1&&(n=1);var o=Math.sqrt(e.x*e.x+e.y*e.y),p=k/this.segs;if(p=Math.abs(p),this.left)var q=Math.easeOutSine(1-p,0,1-p,1);else var q=Math.easeOutSine(p,0,p,1);q*=this.texture.height/2;var r=.001*this.stretch,s=120,q=s+(q-s)*r;e.x/=o,e.y/=o,e.x*=q,e.y*=q,c[m]=f.x+e.x,c[m+1]=f.y+e.y,c[m+2]=f.x-e.x,c[m+3]=f.y-e.y,d=f}this.left?(c[m]=0,c[m+2]=0):(c[0]=0,c[2]=0),PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)}},CrackerHalf.prototype.renderStrip=function(a){var b=PIXI.gl;PIXI.activateStripShader();var c=PIXI.stripShader,d=c.program,e=PIXI.mat3.clone(this.worldTransform);if(PIXI.mat3.transpose(e),this.dirty)this.dirty=!1,b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,this.verticies,b.DYNAMIC_DRAW),b.vertexAttribPointer(c.aVertexPosition,2,b.FLOAT,!1,0,0),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.bufferData(b.ARRAY_BUFFER,this.uvs,b.STATIC_DRAW),b.vertexAttribPointer(c.aTextureCoord,2,b.FLOAT,!1,0,0),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,this.texture.baseTexture._glTexture),b.bindBuffer(b.ARRAY_BUFFER,this._colorBuffer),b.bufferData(b.ARRAY_BUFFER,this.colors,b.STATIC_DRAW),b.vertexAttribPointer(c.colorAttribute,1,b.FLOAT,!1,0,0),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW),b.drawElements(b.TRIANGLE_STRIP,this.indices.length,b.UNSIGNED_SHORT,0);else{{CrackerHalf.crackerShader}b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferSubData(b.ARRAY_BUFFER,0,this.verticies),b.vertexAttribPointer(c.aVertexPosition,2,b.FLOAT,!1,0,0),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.vertexAttribPointer(c.aTextureCoord,2,b.FLOAT,!1,0,0),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,this.texture.baseTexture._glTexture),b.bindBuffer(b.ARRAY_BUFFER,this._colorBuffer),b.vertexAttribPointer(c.colorAttribute,1,b.FLOAT,!1,0,0),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW),b.useProgram(d),b.uniformMatrix3fv(c.translationMatrix,!1,e),b.uniform2f(c.projectionVector,a.x,a.y),b.uniform2f(c.offsetVector,-PIXI.offset.x,-PIXI.offset.y),b.uniform1f(c.alpha,this.worldAlpha),b.drawElements(b.TRIANGLE_STRIP,this.indices.length,b.UNSIGNED_SHORT,0)}PIXI.deactivateStripShader()},Math.easeInQuad=function(a,b,c,d){return a/=d,c*a*a+b},Math.easeInOutCubic=function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b},Math.easeInOutSine=function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b},Math.easeOutSine=function(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b};var CrackerHalfGhost=function(a,b){this.children=[],PIXI.CustomRenderable.call(this),this.shaderTexture=b?PIXI.Texture.fromImage("img/crackerShadow.png"):PIXI.Texture.fromImage("img/crackerHalftone.png"),this.crackerHalf=a,this.shadow=b,this.initWebGL()};CrackerHalfGhost.prototype=Object.create(PIXI.CustomRenderable.prototype),CrackerHalfGhost.prototype.initWebGL=function(){},CrackerHalfGhost.prototype.updateFilterBounds=function(){this.crackerHalf.left?(this.filterArea.x=this.crackerHalf.points[0].x,this.filterArea.y=-100,this.filterArea.width=-this.crackerHalf.points[0].x,this.filterArea.height=300):(this.filterArea.x=0,this.filterArea.y=-100,this.filterArea.width=this.crackerHalf.points[14].x+40,this.filterArea.height=300)},CrackerHalfGhost.prototype.renderWebGL=function(a,b){if(this.visible){var c=PIXI.gl;PIXI.activateStripShader();var d=PIXI.stripShader,e=d.program,f=PIXI.mat3.clone(this.crackerHalf.worldTransform);this.shadow&&(f[2]+=30,f[5]+=30),PIXI.mat3.transpose(f);{CrackerHalf.crackerShader}c.bindBuffer(c.ARRAY_BUFFER,this.crackerHalf._vertexBuffer),c.bufferSubData(c.ARRAY_BUFFER,0,this.crackerHalf.verticies),c.vertexAttribPointer(d.aVertexPosition,2,c.FLOAT,!1,0,0),c.bindBuffer(c.ARRAY_BUFFER,this.crackerHalf._uvBuffer),c.vertexAttribPointer(d.aTextureCoord,2,c.FLOAT,!1,0,0),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,this.shaderTexture.baseTexture._glTexture),c.bindBuffer(c.ARRAY_BUFFER,this.crackerHalf._colorBuffer),c.vertexAttribPointer(d.colorAttribute,1,c.FLOAT,!1,0,0),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.crackerHalf._indexBuffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,this.crackerHalf.indices,c.STATIC_DRAW),c.useProgram(e),c.uniformMatrix3fv(d.translationMatrix,!1,f),c.uniform2f(d.projectionVector,b.x,b.y),c.uniform2f(d.offsetVector,-PIXI.offset.x,-PIXI.offset.y),c.uniform1f(d.alpha,this.crackerHalf.worldAlpha),c.drawElements(c.TRIANGLE_STRIP,this.crackerHalf.indices.length,c.UNSIGNED_SHORT,0),PIXI.deactivateStripShader()}};var Pop=function(){PIXI.DisplayObjectContainer.call(this),this.letters=[],this.spring=new DoubleSpring,this.visible=!1,this.count=0,this.scale.x=this.scale.y=.75,this.setWord(" ")};Pop.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),Pop.prototype.reset=function(){this.exploding=!1,this.falling=!1,this.visible=!1,this.spring.x=this.spring.tx=0,this.spring.y=this.spring.ty=0,this.count=0,this.ratio=0},Pop.prototype.explode=function(a){this.exploding=!0,this.visible=!0,this.count=0,this.setWord(a),this.ratio=1},Pop.prototype.setWord=function(a){for(var b=0;b<this.letters.length;b++){var c=this.letters[b];this.removeChild(c)}this.letters=[],a=a.toLowerCase();var d=a.length,e=a.split("");this.ratio=0;for(var f=0,b=0;d>b;b++){var c;c=" "!=e[b]?PIXI.Sprite.fromFrame(e[b]+".png"):new PIXI.Sprite.fromFrame("space.png"),this.addChild(c),c.anchor.x=.5,c.anchor.y=.6,c.speed=new PIXI.Point,this.letters.push(c),f+=c.width*(1+.1*b)*.8,c.home=new PIXI.Point(0,0),c.tempPo=f}for(var b=0;d>b;b++){var c=this.letters[b];console.log("..");var g=Math.PI/4,h=f*(2*Math.PI/g),i=h/(2*Math.PI),j=c.tempPo/f*g;j-=g/2,j-=.05;var k=i;c.home.x=Math.sin(j)*k,c.home.y=Math.cos(j)*-k+k,c.home.rotation=j,c.speed.y=-10-10*Math.random()}},Pop.prototype.update=function(){if(this.falling)for(var a=0;a<this.letters.length;a++){var b=this.letters[a];b.position.x+=b.speed.x,b.position.y+=b.speed.y,b.speed.y+=1,b.rotation+=.1*(a/this.letters.length-.5)}else{this.exploding&&(this.count++,this.count>60&&this.fallApart()),this.spring.update(),this.spring.tx=this.ratio,this.spring.ty=this.ratio;for(var a=0;a<this.letters.length;a++){var b=this.letters[a];b.position.x=Math.map(this.spring.x,0,b.home.x),b.position.y=Math.map(this.spring.y,0,b.home.y)-20,b.scale.x=b.scale.y=.6+.5*this.spring.x,b.scale.x=b.scale.y*=1+.1*a,b.rotation=b.home.rotation*this.spring.x}}},Pop.prototype.fallApart=function(){this.falling=!0};var Shower=function(){this.children=[],PIXI.CustomRenderable.call(this),this.gems=[PIXI.Texture.fromFrame("gem1.png"),PIXI.Texture.fromFrame("gem2.png"),PIXI.Texture.fromFrame("gem3.png"),PIXI.Texture.fromFrame("gem4.png"),PIXI.Texture.fromFrame("gem5.png"),PIXI.Texture.fromFrame("gem6.png"),PIXI.Texture.fromFrame("gem7.png"),PIXI.Texture.fromFrame("gem8.png"),PIXI.Texture.fromFrame("gem9.png"),PIXI.Texture.fromFrame("gem10.png"),PIXI.Texture.fromFrame("gem11.png"),PIXI.Texture.fromFrame("gem12.png"),PIXI.Texture.fromFrame("gem13.png"),PIXI.Texture.fromFrame("gem14.png"),PIXI.Texture.fromFrame("gem15.png")],this.initWebGL()};Shower.prototype=Object.create(PIXI.CustomRenderable.prototype),Shower.prototype.initWebGL=function(){var a=["attribute vec2 aVertexPosition;","attribute vec2 aMovement;","attribute vec2 aTexture;","uniform mat3 translationMatrix;","uniform float time;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","const float PI = 3.14159265358;","void main(void) {","vec2 v = aVertexPosition;","float x = aMovement.x * 0.01;","vec2 scaledVertex = aVertexPosition;","v.x = (scaledVertex.x) * cos(x) - (scaledVertex.y) * sin(x);","v.y = (scaledVertex.x) * sin(x) + (scaledVertex.y) * cos(x);","v += aMovement;","v.x += 1280.0/2.0;","v.y += 800.0/2.0;","gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / projectionVector.y + 1.0 , 0.0, 1.0);","vTextureCoord = aTexture;","}"],b=["precision lowp float;","varying vec2 vTextureCoord;","uniform sampler2D uSampler;","void main(void) {","gl_FragColor = texture2D(uSampler, vTextureCoord);","}"],c=PIXI.gl;this.program=PIXI.compileProgram(a,b),c.useProgram(this.program),this.translationMatrix=c.getUniformLocation(this.program,"translationMatrix"),this.projectionVector=c.getUniformLocation(this.program,"projectionVector"),this.time=c.getUniformLocation(this.program,"time"),this.aVertexPosition=c.getAttribLocation(this.program,"aVertexPosition"),this.aMovement=c.getAttribLocation(this.program,"aMovement"),this.aTexture=c.getAttribLocation(this.program,"aTexture"),this.totalItems=1e3,this.verticies=new Float32Array(8*this.totalItems),this.movement=new Float32Array(8*this.totalItems),this.posData=new Float32Array(3*this.totalItems),this.texture=new Float32Array(8*this.totalItems),this.indices=new Uint16Array(6*this.totalItems);for(var d=0;d<8*this.totalItems;d+=8){var e=1+Math.random();this.verticies[d]=-20*e,this.verticies[d+1]=-20*e,this.verticies[d+2]=20*e,this.verticies[d+3]=-20*e,this.verticies[d+4]=20*e,this.verticies[d+5]=20*e,this.verticies[d+6]=-20*e,this.verticies[d+7]=20*e}for(var f=502,g=456,h=0,d=0;d<8*this.totalItems;d+=8){h++;var i=this.gems[h%this.gems.length].frame,j=i.x/f,k=i.y/g;this.texture[d]=j,this.texture[d+1]=k,this.texture[d+2]=j+i.width/f,this.texture[d+3]=k,this.texture[d+4]=j+i.width/f,this.texture[d+5]=k+i.height/g,this.texture[d+6]=j,this.texture[d+7]=k+i.height/g}for(var d=0;d<8*this.totalItems;d+=8){var l=1100*Math.random()-550,m=Math.random()*Math.PI*2,n=.3+.9*Math.random(),l=Math.sin(m)*n,o=Math.cos(m)*n;this.movement[d]=l,this.movement[d+1]=o,this.movement[d+2]=l,this.movement[d+3]=o,this.movement[d+4]=l,this.movement[d+5]=o,this.movement[d+6]=l,this.movement[d+7]=o}this.reset();for(var d=0;d<6*this.totalItems;d+=6){var p=d/6*4;this.indices[d]=p,this.indices[d+1]=p+1,this.indices[d+2]=p+2,this.indices[d+3]=p,this.indices[d+4]=p+2,this.indices[d+5]=p+3}this.vertexBuffer=c.createBuffer(),this.textureBuffer=c.createBuffer(),this.movementBuffer=c.createBuffer(),this.indexBuffer=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer),c.bufferData(c.ARRAY_BUFFER,this.verticies,c.STATIC_DRAW),c.bindBuffer(c.ARRAY_BUFFER,this.textureBuffer),c.bufferData(c.ARRAY_BUFFER,this.texture,c.STATIC_DRAW),c.bindBuffer(c.ARRAY_BUFFER,this.movementBuffer),c.bufferData(c.ARRAY_BUFFER,this.movement,c.DYNAMIC_DRAW),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,this.indices,c.STATIC_DRAW),this.count=0,this.speed=18,this.posy=0},Shower.prototype.reset=function(){for(var a=0;a<4*this.totalItems;a+=4){this.posData[a]=0,this.posData[a+1]=0;var b=Math.random()*Math.PI*2,c=10+15*Math.random(),d=Math.sin(b)*c,e=Math.cos(b)*c;this.posData[a+2]=d,this.posData[a+3]=e-10}},Shower.prototype.renderWebGL=function(a,b){if(this.visible){this.speed-=.4,this.count+=this.speed;var c=PIXI.gl;c.disableVertexAttribArray(PIXI.defaultShader.aVertexPosition),c.disableVertexAttribArray(PIXI.defaultShader.colorAttribute),c.disableVertexAttribArray(PIXI.defaultShader.aTextureCoord),c.useProgram(this.program),c.enableVertexAttribArray(this.aVertexPosition),c.enableVertexAttribArray(this.aMovement),c.enableVertexAttribArray(this.aTexture),c.blendFunc(c.ONE,c.ONE_MINUS_SRC_ALPHA),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,this.gems[0].baseTexture._glTexture),c.uniform1f(this.time,this.count),c.uniform2f(this.projectionVector,b.x,b.y),c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer),c.vertexAttribPointer(this.aVertexPosition,2,c.FLOAT,!1,0,0),c.bindBuffer(c.ARRAY_BUFFER,this.textureBuffer),c.vertexAttribPointer(this.aTexture,2,c.FLOAT,!1,0,0);for(var d=0;d<8*this.totalItems;d+=8){var e=d/8*4;this.posData[e+3]+=.7,this.posData[e]+=this.posData[e+2],this.posData[e+1]+=this.posData[e+3];var f=this.posData[e],g=this.posData[e+1];this.movement[d]=f,this.movement[d+1]=g,this.movement[d+2]=f,this.movement[d+3]=g,this.movement[d+4]=f,this.movement[d+5]=g,this.movement[d+6]=f,this.movement[d+7]=g
}c.bindBuffer(c.ARRAY_BUFFER,this.movementBuffer),c.bufferSubData(c.ARRAY_BUFFER,0,this.movement),c.vertexAttribPointer(this.aMovement,2,c.FLOAT,!1,0,0),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer),c.drawElements(c.TRIANGLES,6*this.totalItems,c.UNSIGNED_SHORT,0),c.disableVertexAttribArray(this.aVertexPosition),c.disableVertexAttribArray(this.aMovement),c.disableVertexAttribArray(this.aTexture),c.useProgram(PIXI.defaultShader.program),c.enableVertexAttribArray(PIXI.defaultShader.aVertexPosition),c.enableVertexAttribArray(PIXI.defaultShader.colorAttribute),c.enableVertexAttribArray(PIXI.defaultShader.aTextureCoord)}};var Spikes=function(a){PIXI.DisplayObjectContainer.call(this),this.ratio=0,this.spikes=[],this.front=new PIXI.DisplayObjectContainer,this.back=new PIXI.DisplayObjectContainer,this.back.position.x=5,this.back.position.y=5,this.addChild(this.back);for(var b=0;8>b;b++){var c=PIXI.Sprite.fromImage("img/spikeRear.png");if(0==a){var d=new PIXI.Sprite.fromImage("img/spikeRear.png");this.rotPos=0,this.scale.x=this.scale.y=1}else if(1==a){var d=new PIXI.Sprite.fromImage("img/spikeMid.png");this.scale.x=this.scale.y=1,this.rotPos=.3}else{var d=new PIXI.Sprite.fromImage("img/spike.png");this.rotPos=.6,this.scale.x=this.scale.y=1}var e=b/8*Math.PI*2,f=21;d.rotation=-e+Math.PI/2,d.anchor.y=.5,d.speed=new PIXI.Point(Math.sin(e)*f,Math.cos(e)*f),d.scale.x=d.scale.y=.8+1*Math.random(),this.spikes.push(d),this.addChild(d),c.position=d.position,c.anchor=d.anchor,c.rotation=d.rotation,d.rear=c,0!=a&&this.back.addChild(c)}this.spring=new DoubleSpring,this.spring.tx=1,this.popArtFilter=new PIXI.DropShadowFilter,this.visible=!1};Spikes.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),Spikes.prototype.reset=function(){this.spring.x=0,this.spring.tx=1,this.exploding=!1,this.visible=!1},Spikes.prototype.explode=function(a){this.exploding=!0,this.visible=!0,this.ratio=0,TweenLite.to(this,.6,{delay:a,ratio:1,ease:Elastic.easeOut,onComplete:function(){TweenLite.to(this,.2,{ratio:0,ease:Expo.easeIn,delay:.1})}.bind(this)})},Spikes.prototype.update=function(){if(this.exploding){this.spring.update(),this.rotation=this.ratio+this.rotPos;for(var a=this.ratio,b=0;b<this.spikes.length;b++){var c=this.spikes[b];c.scale.x=c.scale.y*a,c.rear.scale.x=1*c.scale.x,c.rear.scale.y=1.6*c.scale.y}}};var Spikes2=function(){PIXI.DisplayObjectContainer.call(this),this.spikes=[];for(var a=0;20>a;a++){var b=new PIXI.Sprite.fromImage("img/spike.png"),c=a/20*Math.PI*2,d=21+10*Math.random();b.rotation=-c+Math.PI/2,b.anchor.y=.5,b.speed=new PIXI.Point(Math.sin(c)*d,Math.cos(c)*d),b.scale.x=b.scale.y=.5+1*Math.random(),this.spikes.push(b)}this.spring=new DoubleSpring,this.spring.tx=1,this.popArtFilter=new PIXI.DotScreenFilter,this.popArtFilter.scale=.1,this.visible=!1};Spikes2.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),Spikes2.prototype.explode=function(){this.exploding=!0,this.visible=!0},Spikes2.prototype.update=function(){if(this.exploding){this.spring.update();for(var a=this.spring.x,b=0;b<this.spikes.length;b++){var c=this.spikes[b];c.scale.x=c.scale.y*a,c.speed.x*=.99,c.speed.y+=.5,c.rotation=-Math.atan2(c.speed.x,c.speed.y)+Math.PI/2,c.position.x+=c.speed.x,c.position.y+=c.speed.y}}};var PIXI=PIXI||{};Tentacle=function(a,b){this.chain=new Chain,this.count=100*Math.random(),this.speed=1+2*Math.random(),this.chain.build(250),this.targetPoint=new PIXI.Point,PIXI.Rope.call(this,a,this.chain.links),this.width=b},Tentacle.constructor=Tentacle,Tentacle.prototype=Object.create(PIXI.Rope.prototype),Tentacle.prototype.updateTransform=function(){PIXI.Rope.prototype.updateTransform.call(this),this.targetPoint.x+=.3*(this.stage.interactionManager.mouse.global.x-this.worldTransform[2]-this.targetPoint.x),this.targetPoint.y+=.3*(this.stage.interactionManager.mouse.global.y-this.worldTransform[5]-this.targetPoint.y),this.chain.update(this.targetPoint),this.count+=.3*this.speed;for(var a=this.points,b=0;b<a.length;b++);},PIXI.BulgeFilter=function(){PIXI.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512*.5},dimensions:{type:"4fv",value:new Float32Array([100,100,10,10])}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float blur;","uniform vec4 dimensions;","const float strength = 0.2;","const float radius = 0.5;","uniform sampler2D uSampler;","void main(void) {","vec2 coord = vTextureCoord;","coord /= dimensions.xy;","coord /= dimensions.zw;","gl_FragColor = vec4(dimensions.x / vTextureCoord.x , 0.0, 0.0, 1.0);","}"]},PIXI.BulgeFilter.prototype=Object.create(PIXI.AbstractFilter.prototype),PIXI.BulgeFilter.prototype.constructor=PIXI.BulgeFilter,CrackerShader=function(){this.program,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","const vec4 dimensions = vec4(300.0, 300.0, 0.0, 0.0);","uniform sampler2D uSampler;","uniform sampler2D uSampler2;","const float angle = 5.0;","const float scale = 0.2;","float pattern() {","float s = sin(angle), c = cos(angle);","vec2 tex = vTextureCoord * dimensions.xy;","vec2 point = vec2(","c * tex.x - s * tex.y,","s * tex.x + c * tex.y",") * scale;","return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","vec4 color = texture2D(uSampler, vTextureCoord);","gl_FragColor = vec4(0.0, 0.0, 0.0, 0.3);","gl_FragColor *= color.a;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColo§r;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","varying vec2 offsetVector;","varying float vColor;","void main(void) {","vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","v *= 0.9;","v += vec3(70.0, 70.0, 1.0);","gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y)/ projectionVector.y + 1.0 , 0.0, 1.0);","vTextureCoord = aTextureCoord;","vColor = aColor;","}"]},CrackerShader.prototype.init=function(){var a=PIXI.compileProgram(this.vertexSrc,this.fragmentSrc),b=PIXI.gl;b.useProgram(a),this.uSampler=b.getUniformLocation(a,"uSampler"),this.uSampler2=b.getUniformLocation(a,"uSampler2"),this.projectionVector=b.getUniformLocation(a,"projectionVector"),this.offsetVector=b.getUniformLocation(a,"offsetVector"),this.colorAttribute=b.getAttribLocation(a,"aColor"),-1==this.colorAttribute&&(this.colorAttribute=2),this.aVertexPosition=b.getAttribLocation(a,"aVertexPosition"),this.aTextureCoord=b.getAttribLocation(a,"aTextureCoord"),this.translationMatrix=b.getUniformLocation(a,"translationMatrix"),this.alpha=b.getUniformLocation(a,"alpha"),this.program=a},PIXI.activateCrackerShader=function(){var a=PIXI.gl;a.disableVertexAttribArray(PIXI.defaultShader.aVertexPosition),a.disableVertexAttribArray(PIXI.defaultShader.colorAttribute),a.disableVertexAttribArray(PIXI.defaultShader.aTextureCoord),a.useProgram(PIXI.stripShader.program),a.enableVertexAttribArray(PIXI.stripShader.aVertexPosition),a.enableVertexAttribArray(PIXI.stripShader.colorAttribute),a.enableVertexAttribArray(PIXI.stripShader.aTextureCoord)},PIXI.deactivateCrackerShader=function(){var a=PIXI.gl;a.useProgram(PIXI.defaultShader.program),a.disableVertexAttribArray(PIXI.stripShader.aVertexPosition),a.disableVertexAttribArray(PIXI.stripShader.colorAttribute),a.disableVertexAttribArray(PIXI.stripShader.aTextureCoord),a.enableVertexAttribArray(PIXI.defaultShader.aVertexPosition),a.enableVertexAttribArray(PIXI.defaultShader.colorAttribute),a.enableVertexAttribArray(PIXI.defaultShader.aTextureCoord)},PIXI.DropShadowFilter=function(){PIXI.AbstractFilter.call(this),this.padding=20,this.passes=[this],this.uniforms={blur:{type:"1f",value:.8}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","vec4 sum = vec4(0.0);","float sample = texture2D(uSampler,vTextureCoord).a;","gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);","gl_FragColor *= step(1.0-sample, blur);","}"]},PIXI.DropShadowFilter.prototype=Object.create(PIXI.AbstractFilter.prototype),PIXI.DropShadowFilter.prototype.constructor=PIXI.DropShadowFilter,PIXI.DropShadowPhase2Filter=function(){PIXI.AbstractFilter.call(this),this.passes=[this],this.padding=20,this.uniforms={blur:{type:"1f",value:1/512*.5}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","vec4 sum = vec4(0.0);","sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","float alpha = smoothstep( 0.0, 0.1, sum.a );","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","gl_FragColor.a = alpha;","}"]},PIXI.DropShadowPhase2Filter.prototype=Object.create(PIXI.AbstractFilter.prototype),PIXI.DropShadowPhase2Filter.prototype.constructor=PIXI.DropShadowPhase2Filter,PIXI.DustFilter=function(){PIXI.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:.4},angle:{type:"1f",value:2},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","float s = sin(angle), c = cos(angle);","vec2 tex = vTextureCoord * dimensions.xy;","vec2 point = vec2(","c * tex.x - s * tex.y,","s * tex.x + c * tex.y",") * scale;","return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","vec4 color = texture2D(uSampler, vTextureCoord);","float average = (color.r + color.g + color.b) / 3.0;","vec4 outputx = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","gl_FragColor = vec4(221.0 / 255.0, 85.0/255.0, 20.0 / 255.0, 1.0);","gl_FragColor *= clamp(outputx.r, 0.0, 1.0);","}"]},PIXI.DustFilter.prototype=Object.create(PIXI.DustFilter.prototype),PIXI.DustFilter.prototype.constructor=PIXI.DustFilter,Object.defineProperty(PIXI.DustFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(a){this.dirty=!0,this.uniforms.scale.value=a}}),Object.defineProperty(PIXI.DustFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(a){this.dirty=!0,this.uniforms.angle.value=a}}),PIXI.HalfToneFilter=function(){PIXI.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","float s = sin(angle), c = cos(angle);","vec2 tex = vTextureCoord * dimensions.xy;","vec2 point = vec2(","c * tex.x - s * tex.y,","s * tex.x + c * tex.y",") * scale;","return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","vec4 color = texture2D(uSampler, vTextureCoord);","float average = (color.r + color.g + color.b) / 3.0;","vec4 outputx = vec4(vec3(average * 0.8 * 10.0 - 5.0 + pattern()), color.a);","gl_FragColor = vec4(70.0 / 255.0, 51.0/255.0, 66.0 / 255.0, 1.0);","gl_FragColor *= clamp(outputx.r, 0.0, 1.0);","}"]},PIXI.HalfToneFilter.prototype=Object.create(PIXI.HalfToneFilter.prototype),PIXI.HalfToneFilter.prototype.constructor=PIXI.HalfToneFilter,Object.defineProperty(PIXI.HalfToneFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(a){this.dirty=!0,this.uniforms.scale.value=a}}),Object.defineProperty(PIXI.HalfToneFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(a){this.dirty=!0,this.uniforms.angle.value=a}}),PIXI.RippleFilter=function(a){PIXI.AbstractFilter.call(this),this.passes=[this],this.uniforms={displacementMap:{type:"sampler2D",value:a},scale:{type:"2f",value:{x:180,y:180}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]},superScale:{type:"2f",value:{x:5,y:5}}},a.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=a.width,this.uniforms.mapDimensions.value.y=a.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),a.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","uniform vec2 superScale;","void main(void) {","vec2 mapCords = vTextureCoord.xy;","mapCords += (dimensions.zw + offset)/ dimensions.xy ;","mapCords.y *= -1.0;","mapCords.y += 1.0;","mapCords -= 0.5;","mapCords *= superScale;","mapCords += 0.5;","vec2 matSample = texture2D(displacementMap, mapCords).xy;","matSample -= 0.5;","matSample *= scale;","matSample /= mapDimensions;","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","vec2 cord = vTextureCoord;","gl_FragColor = gl_FragColor * vColor;","}"]},PIXI.RippleFilter.prototype=Object.create(PIXI.AbstractFilter.prototype),PIXI.RippleFilter.prototype.constructor=PIXI.RippleFilter,PIXI.RippleFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height,this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(PIXI.RippleFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(a){this.uniforms.displacementMap.value=a}}),Object.defineProperty(PIXI.RippleFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(a){this.uniforms.scale.value=a}}),Object.defineProperty(PIXI.RippleFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(a){this.uniforms.offset.value=a}}),PIXI.ShaderSprite=function(){PIXI.CustomRenderable.call(this)},PIXI.ShaderSprite.prototype=Object.create(PIXI.CustomRenderable.prototype),PIXI.ShaderSprite.prototype.constructor=PIXI.CustomRenderable,PIXI.ShaderSprite.prototype.initWebGL=function(){var a=PIXI.this.vertexBuffer=a.createBuffer();this.indexBuffer=a.createBuffer(),this.uvBuffer=a.createBuffer(),this.colorBuffer=a.createBuffer()},PIXI.ShaderSprite.prototype.renderWebGL=function(){console.log("RENDERING")},PIXI.ShadowFilter=function(){PIXI.AbstractFilter.call(this),this.passes=[this];var a=PIXI.Texture.fromImage("img/halftone16.png");a.baseTexture._powerOf2=!0,this.uniforms={tile:{type:"sampler2D",value:a},scale:{type:"1f",value:1},scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform sampler2D tile;","uniform float angle;","uniform float scale;","void main() {","vec2 v = vTextureCoord;","v /= 16.0;","v *= dimensions.xy;","vec4 color = texture2D(tile, v );","float alpha = texture2D(uSampler, vTextureCoord).a;","gl_FragColor = color * alpha;","}"]},PIXI.ShadowFilter.prototype=Object.create(PIXI.ShadowFilter.prototype),PIXI.ShadowFilter.prototype.constructor=PIXI.ShadowFilter,Object.defineProperty(PIXI.ShadowFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(a){this.dirty=!0,this.uniforms.scale.value=a}}),Object.defineProperty(PIXI.ShadowFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(a){this.dirty=!0,this.uniforms.angle.value=a}}),PIXI.ZoomBlurFilter=function(){PIXI.AbstractFilter.call(this),this.passes=[this],this.uniforms={strength:{type:"1f",value:0}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform sampler2D uSampler;","const vec2 center = vec2(800.0/2.0, 600.0/2.0);","uniform float strength;","const vec2 texSize = vec2(800.0, 600.0);","float random(vec3 scale, float seed) {","return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);","}","void main(void) {","vec4 color = vec4(0.0);","float total = 0.0;","vec2 toCenter = center - vTextureCoord * texSize;","float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);","for (float t = 0.0; t <= 40.0; t++) {","float percent = (t + offset) / 40.0;","float weight = 4.0 * (percent - percent * percent);","vec4 sample = texture2D(uSampler, vTextureCoord + toCenter * percent * strength / texSize);","sample.rgb *= sample.a;","color += sample * weight;","total += weight;","}"," gl_FragColor = color / total;","}"]},PIXI.ZoomBlurFilter.prototype=Object.create(PIXI.AbstractFilter.prototype),PIXI.ZoomBlurFilter.prototype.constructor=PIXI.ZoomBlurFilter,Object.defineProperty(PIXI.ZoomBlurFilter.prototype,"strength",{get:function(){return this.uniforms.strength.value},set:function(a){this.uniforms.strength.value=a}});var DivButton=function(a,b){this.view=document.createElement("div"),this.view.style.cursor="pointer",this.overImage=new Image,this.overImage.style.position="absolute",this.overImage.style.opacity=0,this.overImage.src=b,this.upImage=new Image,this.upImage.src=a,this.view.appendChild(this.upImage),this.view.onmouseover=function(){TweenLite.to(this.upImage,.3,{autoAlpha:.6})}.bind(this),this.view.onmouseout=function(){TweenLite.to(this.upImage,.3,{autoAlpha:1})}.bind(this)},DoubleSpring=function(){this.x=0,this.ax=0,this.dx=0,this.tx=0,this.y=0,this.ay=0,this.dy=0,this.ty=0,this.max=30,this.damp=.85,this.springiness=.09};max=160,damp=.85,springiness=.29,DoubleSpring.constructor=DoubleSpring,DoubleSpring.prototype.update=function(){this.ax=(this.tx-this.x)*springiness,this.dx+=this.ax,this.dx*=damp,this.dx<-max?this.dx=-max:this.dx>max&&(this.dx=max),this.x+=this.dx,this.ay=(this.ty-this.y)*springiness,this.dy+=this.ay,this.dy*=damp,this.dy<-max?this.dy=-max:this.dy>max&&(this.dy=max),this.y+=this.dy},DoubleSpring.prototype.reset=function(){this.x=0,this.ax=0,this.dx=0,this.tx=0,this.y=0,this.ay=0,this.dy=0,this.ty=0},Math.smallestCirculerDistance=function(a,b,c){var d=b-a,e=b+c-a,f=b-c-a,g=Math.abs(d),h=Math.abs(e),i=Math.abs(f),j=d;return g>h&&i>h?j=e:g>i&&h>i&&(j=f),j},Math.modulo=function(a,b){return a%=b,0>a&&(a+=b),a},Math.cap=function(a,b,c){return b>a?b:a>c?c:a},Math.map=function(a,b,c){return b+(c-b)*a},window.console||(window.console={log:function(){}});var Profile=function(){};checkIsMobile=function(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a},Profile.init=function(){},Profile.prototype.buildProfile=function(){var a=navigator.userAgent.toLowerCase(),b=a.indexOf("android")>-1;this.flipTilt=b?-1:1,this.firefox=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,this.mobile=checkIsMobile();var c=window.navigator.userAgent;this.msie=-1!=window.navigator.userAgent.toLowerCase().indexOf("msie"),this.ipad=null!=c.match(/iPad/i),this.ipod=null!=c.match(/iPod/i),this.iphone=null!=c.match(/iPhone/i),this.ios=this.ipad||this.ipod||this.iphone,this.is3g=!(window.devicePixelRatio>1)&&this.iphone,this.needsProfile=this.ipad||this.mobile,this.ios||(this.needsProfile=!1)},Profile.prototype.setup=function(a){22>a?(this.particles=!1,this.extra=!1,this.drawDistance=4620,this.trackSize=15,this.drawPosts=!1,this.music=!1,this.sfx=!1,this.canTilt=!1):(this.particles=!0,this.extra=!0,this.drawDistance=7e3,this.trackSize=32,this.drawPosts=!0,this.music=!0,this.sfx=!0,this.canTilt=!0),this.mobile&&(this.music=!1,this.sfx=!1)};